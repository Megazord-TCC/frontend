
<div class="strategy-detail-layout">

  <div class="strategy-detail-content">

    <div class="breadcrumb">
      <span>Início</span>
      <span class="separator">></span>
      <span (click)="goBack()" class="breadcrumb-link">Estratégias</span>
      <span class="separator">></span>
      <span class="current">{{criteria?.name}}</span>
    </div>


    <div class="strategy-header">
      <div class="header-top">
        <button class="back-btn" (click)="goBack()">
          <app-svg-icon
            class="nav-icon"
            [path]="'assets/icon/voltar_vetor.svg'"
            [size]="18">
          </app-svg-icon>
        </button>
        <h1>{{criteria?.name}}</h1>

      </div>
      <p class="strategy-description">{{criteria?.description}}</p>
      <div class="action-header">
        <div class="action-buttons">
          <button class="action-btn" (click)="editCriteria()">
            <i class="icon-edit"></i>
            Editar
          </button>
          <!--
            <button class="action-btn cancel" (click)="cancelStrategy()">
              <i class="icon-cancel"></i>
              Cancelar
            </button>
            -->
          <button class="action-btn delete" (click)="deleteCriteria()">
            <i class="icon-delete"></i>
            Excluir
          </button>
        </div>

        <div class="last-update">
          <i class="icon-clock"></i>
          Última alteração realizada por Carlos Krefer em 01/01/2025 13:30.
        </div>
      </div>
    </div>


    <div class="tabs-container">
      <div class="tabs-list">
        <button
          class="tab-trigger"
          [class.active]="activeTab === 'diretas'"
          (click)="onTabChange('diretas')">
          <app-svg-icon
            class="nav-icon"
            [path]="'assets/icon/p_vetor.svg'"
            [size]="18">
          </app-svg-icon>
          <span class="tab-number">1.</span>
          Comparações diretas
        </button>
        <button
          class="tab-trigger"
          [class.active]="activeTab === 'reciprocas'"
          (click)="onTabChange('reciprocas')">
          <app-svg-icon
            class="nav-icon"
            [path]="'assets/icon/metrica_vetor.svg'"
            [size]="18">
          </app-svg-icon>
          <span class="tab-number">2.</span>
          Comparações recíprocas
        </button>
        <!--
          <button
          class="tab-trigger"
          [class.active]="activeTab === 'objetivos'"
          (click)="onTabChange('avaliacoes')">
          <app-svg-icon
          class="nav-icon"
          [path]="'assets/icon/assignment_projetos_vetor.svg'"
          [size]="18">
        </app-svg-icon>
        <span class="tab-number">3.</span>
        Grupos de avaliações
      </button>
      -->

      </div>


      <div class="tab-content">

        <div *ngIf="activeTab === 'diretas'" class="tab-panel">
          <h3>Comparações diretas</h3>
          <p class="tab-description">
            Compare este critério aos outros do mesmo grupo. A partir disso será atribuído um peso para cada um.
          </p>
          <div class="actions-right">

            <div class="search-container">

              <app-svg-icon
                class="nav-icon"
                [path]="'assets/icon/search_vetor.svg'"
                [size]="18">
              </app-svg-icon>
              <input
                type="text"
                placeholder="Buscar pelo nome do projeto"
                [(ngModel)]="searchTerm"
                (input)="onSearchChange()">
            </div>
          </div>


          <app-card class="table-card">
            <div class="table-container">
              <table >
                <thead>
                  <tr>
                    <th>
                      <div class="header-cell">
                        Critério atual
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>
                    <th>
                      <div class="header-cell">
                        Comparação
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>
                    <th>
                      <div class="header-cell">
                        Critério comparado
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>

                  </tr>
                </thead>
                <tbody>
                  <ng-container *ngIf="criteria">
                     <tr *ngFor="let otherCriteria of getOtherCriteria()" class="table-row">
                      <td>{{criteria?.name}}</td>
                      <td>
                        <select [(ngModel)]="comparisonValues[criteria.id][otherCriteria.id]"
                                (change)="onImportanceChange(criteria, otherCriteria)">
                          <option *ngFor="let scale of importanceScales" [value]="scale">
                            {{ importanceScaleMap[scale] }}
                          </option>
                        </select>
                      </td>
                      <td>{{otherCriteria.name}}</td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
          </app-card>
        </div>


        <div *ngIf="activeTab === 'reciprocas'" class="tab-panel">
          <h3>Comparações recíprocas</h3>
          <p class="tab-description">
            Confira as comparações feitas a partir de outros critérios em relação ao atual. Para alterar o valor, acesse o outro critério, clicando em seu nome.
          </p>


          <div class="actions-right">

            <div class="search-container">

              <app-svg-icon
                class="nav-icon"
                [path]="'assets/icon/search_vetor.svg'"
                [size]="18">
              </app-svg-icon>
              <input
                type="text"
                placeholder="Buscar pelo nome do projeto"
                [(ngModel)]="searchTerm"
                (input)="onSearchChange()">
            </div>
          </div>


          <app-card class="table-card">
            <div class="table-container">
              <div class="div-loading-projetcts" *ngIf="loadingCriterios">Carregando grupo de critério...</div>
              <table *ngIf="!loadingCriterios">
                <thead>
                  <tr>
                    <th>
                      <div class="header-cell">
                        Nome do grupo de critério
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>
                    <th>
                      <div class="header-cell">
                        Objetivos vinculados
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>
                    <th>
                      <div class="header-cell">
                        Avaliações realizadas
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>
                    <th>
                      <div class="header-cell">
                        Status
                        <app-svg-icon
                          class="nav-icon"
                          [path]="'assets/icon/sort-alt.svg'"
                          [size]="18">
                        </app-svg-icon>
                      </div>
                    </th>
                  </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let criteria of criteriaGroups" class="table-row">
                      <td>{{criteria.name}}</td>
                      <td>2 de 2</td>
                      <td>{{criteria.name}}</td>
                    </tr>
                </tbody>
              </table>
            </div>
          </app-card>
        </div>

        <!--
          <div *ngIf="activeTab === 'objetivos'" class="tab-panel">
            <h3>Grupo de avaliações de projetos</h3>
            <p class="tab-description">
              Cadastre grupos de avaliações de projetos a partir de grupos de critérios. Essas avaliações são utilizadas para gerar cenários.
            </p>
            <div class="actions-right">
              <button class="btn-primary" (click)="openCreateModal()">
                <i class="icon-plus">+</i>
                Cadastrar
              </button>
              <div class="search-container">
                <app-svg-icon
                class="nav-icon"
                [path]="'assets/icon/search_vetor.svg'"
                [size]="18">
              </app-svg-icon>
              <input
              type="text"
              placeholder="Buscar pelo nome do projeto"
              [(ngModel)]="searchTerm"
              (input)="onSearchChange()">
            </div>
          </div>
          <app-card class="table-card">
            <div class="table-container">
              <table class="evaluations-table">
                <thead>
                  <tr>
                    <th>
                      <div class="header-cell">
                        Nome da avaliação
                        <i class="icon-sort">↕️</i>
                      </div>
                    </th>
                    <th>
                      <div class="header-cell">
                        Grupo de critérios
                        <i class="icon-sort">↕️</i>
                      </div>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let evaluation of filteredEvaluationGroups" class="table-row">
                    <td>
                      <button class="evaluation-link" (click)="openEvaluationModal(evaluation)">
                        {{evaluation.name}}
                      </button>
                    </td>
                    <td>{{evaluation.criteriaGroup}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </app-card>
        </div>
        -->
      </div>
    </div>
  </div>
</div>


